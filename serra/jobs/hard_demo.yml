cast_rating:
  class_name: CastColumnTransformer
  config:
    cast_columns:
      rating:
      - rating
      - double
    input_block: join_ratings
debug: true
join_ratings:
  class_name: JoinTransformer
  config:
    join_on:
      read_ratings: id
      read_sales: id
    join_type: inner
pivot_table:
  class_name: PivotTransformer
  config:
    aggregate_type: avg
    column_level: region_abbr
    input_block: cast_rating
    row_level: restaurant
    sum_col: rating
read_ratings:
  class_name: LocalReader
  config:
    file_path: ./examples/ratings.csv
read_sales:
  class_name: LocalReader
  config:
    file_path: ./examples/sales.csv
region_mapping:
  class_name: MapTransformer
  config:
    col_key: region
    input_block: read_sales
    map_dict:
      Alabama: AL
      Alaska: AK
      Arizona: AZ
      Arkansas: AR
      California: CA
      Colorado: CO
      Connecticut: CT
      Delaware: DE
      Florida: FL
      Georgia: GA
      Hawaii: HI
      Idaho: ID
      Illinois: IL
      Indiana: IN
      Iowa: IA
      Kansas: KS
      Kentucky: KY
      Louisiana: LA
      Maine: ME
      Maryland: MD
      Massachusetts: MA
      Michigan: MI
      Minnesota: MN
      Mississippi: MS
      Missouri: MO
      Montana: MT
      Nebraska: NE
      Nevada: NV
      New Hampshire: NH
      New Jersey: NJ
      New Mexico: NM
      New York: NY
      North Carolina: NC
      North Dakota: ND
      Ohio: OH
      Oklahoma: OK
      Oregon: OR
      Pennsylvania: PA
      Rhode Island: RI
      South Carolina: SC
      South Dakota: SD
      Tennessee: TN
      Texas: TX
      Utah: UT
      Vermont: VT
      Virginia: VA
      Washington: WA
      West Virginia: WV
      Wisconsin: WI
      Wyoming: WY
    name: region_abbr
step_write:
  class_name: LocalWriter
  config:
    file_path: ./examples/output.csv
    input_block: pivot_table
